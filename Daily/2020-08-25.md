# August 25, 2020

Installing a dependency into the R container.  And just to make it challenging let's say it's RODBC ([superseded][odbc release] by the newer odbc package), and let's also say we need to be running the not-latest version of R (say 3.6.3).

Updating the `dependencies.r` script to try out the easy method:

```r
install.packages("RODBC")
```

The first failure tells us that the package isn't compatible with R < 4.0.  So we'll hit up the [archives] instead, and install a specific version (which I guessed was the latest one):

```r
install.packages("https://cran.r-project.org/src/contrib/Archive/RODBC/RODBC_1.3-16.tar.gz", repos=NULL, type="source")
```

This time we get a post-install error complaining that the command `sh` isn't found.  A quick Google later and this looks like an issue related to running R on Windows, where some packages aren't just binaries (and need to build).  This is solved by install [RTools] - though obviously not the latest version, we need to go back to the 3.3-3.5 branch.  This is going to go into the base image (`rservercore`):

```dockerfile
RUN curl.exe -o c:\tmp\rtools35.exe https://cran.r-project.org/bin/windows/Rtools/Rtools35.exe
RUN c:\tmp\rtools35.exe /VERYSILENT /DIR="C:\RTools\"

RUN setx path "%path%;C:\RTools\bin"
```

We add the `bin` folder to the path after installing.

This finally allows for the package to be installed, and our `rscripts` image can now do something with RODBC.

[odbc release]: https://blog.revolutionanalytics.com/2017/08/a-modern-database-interface-for-r.html
[archives]: https://cran.r-project.org/src/contrib/Archive/RODBC/
[RTools]: https://cran.r-project.org/bin/windows/Rtools/